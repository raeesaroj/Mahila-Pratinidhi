{% extends 'public/public_base.html' %}
{% load staticfiles %}
{% block upper_content %}
<script src="https://d3js.org/d3.v5.js"></script>
<script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
<script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
<!-- style for chart -->
<style>
  div#container {
  width: 1000px;
  height: 600px;
  margin: auto;
  background-color: #2F4A6D;
}

svg {
  width: 100%;
  height: 100%;
}

.bar {
  fill: #8e1c85;
}

text {
  font-size: 12px;
  fill: #fff;
}

path {
  stroke: gray;
}

line {
  stroke: gray;
}

line#limit {
  stroke: #FED966;
  stroke-width: 3;
  stroke-dasharray: 3 6;
}

.grid path {
  stroke-width: 0;
}

.grid .tick line {
  stroke: #9FAAAE;
  stroke-opacity: 0.3;
}

text.divergence {
  font-size: 12px;
  fill: white;
}

text.value {
  font-size: 10px;
}

text.title {
  font-size: 22px;
  font-weight: 600;
}

text.label {
  font-size: 14px;
  font-weight: 400;
}

text.source {
  font-size: 14px;
}

</style>

<!-- style for chart -->
<body>

    <header>
        <div class="navigation innerPage">
            <div class="container-fluid">
{% endblock %}
{% block lower_content %}
            </div>
        </div>
    </header>

    <section class="topbg">
        <div class="container">
            <div class="row centered">
                <div class="col hdn">
                    <img class="imgeye" src="{% static 'public/image/eye.png' %}" alt="eye">
                </div>
                <div class="col">
                    <p class="dtitle">
                        Mahila Pratinidhi in Data
                    </p>
                    <div class="countsHolder">
                        <div class="counts">
                            <div class="dcount">
                                {{ total }}
                            </div>
                            <div class="text">
                                <div class="bold">Total Female</div>
                                <div class="lighter"> Representatives</div>
                            </div>

                        </div>
                        <div class="counts">
                            <div class="dcount">
                                {{ direct }}
                            </div>
                            <div class="text">
                                <div class="bold">Directly Elected
                                </div>
                                <div class="lighter"> Representatives</div>
                            </div>

                        </div>
                        <div class="counts">
                            <div class="dcount">
                                {{married}}
                            </div>
                            <div class="text">
                                <div class="bold">Married Female
                                </div>
                                <div class="lighter"> Representatives</div>
                            </div>

                        </div>
                        <div class="counts">
                            <div class="dcount">
                                {{ graduate }}
                            </div>
                            <div class="text">
                                <div class="bold">Graduated Female

                                </div>
                                <div class="lighter"> Representatives</div>
                            </div>

                        </div>
                    </div>
                    <img class="graph" src="{% static 'public/image/graph.png' %}" alt="">
                </div>

            </div>


        </div>

    </section>

    <section class="all">

        <div class="container-fluid">

            <div class="tabHolder row centered">
                <div class="col dtitle1">
                    <div class="gtitle">
                        <p class="innerp"> POLITICAL ENGAGEMENT</p>
                    </div>
                </div>
                <div class="col dcontent">
                    Lorem ipsum, dolor sit amet consectetur adipisicing elit. Officiis nobis hic voluptatibus fugiat animi? Voluptates exercitationem
                    quam culpa nisi inventore laboriosam facere, unde, repudiandae consequuntur odio quas obcaecati nobis
                    animi ducimus nulla necessitatibus rem voluptatum ad expedita ut! Ratione officia consequatur cum ducimus
                    excepturi iste, veritatis, corrupti quas natus nostrum libero saepe neque omnis vero architecto nam delectus,
                    perspiciatis qui rem vitae labore! Officiis, tenetur nihil. Quae odio facere soluta quaerat nostrum velit
                    dicta nulla eius, tempore, quasi possimus quidem nemo. Ratione veniam laudantium illo pariatur placeat
                    veritatis, fuga est illum, minus dignissimos ullam sapiente dolores autem earum reiciendis iste harum
                    consequatur, provident quae vero nihil repellat unde. Earum placeat veritatis rerum excepturi voluptatum,
                    ex blanditiis quo labore quas dolorum, harum laboriosam inventore sunt! Facere hic dolores suscipit quibusdam
                    reiciendis eius maiores ratione cumque dolor. Eveniet sunt illum excepturi sed nam dolore animi laborum
                    quis asperiores commodi autem sint, repudiandae, vel nulla! Minima sunt provident maiores repudiandae
                    accusantium. Maiores, eaque sapiente porro voluptates perferendis tempora nesciunt a ex qui. Dicta alias,
                    incidunt v Lorem ipsum, dolor sit amet consectetur adipisicing elit. Officiis nobis hic voluptatibus
                    fugiat animi? Voluptates exercitationem quam culpa nisi inventore laboriosam facere, unde, repudiandae
                    consequuntur odio quas obcaecati nobis animi ducimus nulla necessitatibus rem voluptatum ad expedita
                    ut! Ratione officia consequatur cum ducimus excepturi iste, veritatis, corrupti quas natus nostrum libero
                    saepe neque omnis vero architecto nam delectus, perspiciatis qui rem vitae labore! Officiis, tenetur
                    nihil. Quae odio facere soluta quaerat nostrum velit dicta nulla eius, tempore, quasi possimus quidem
                    nemo. Ratione veniam laudantium illo pariatur placeat veritatis, fuga est illum, minus dignissimos ullam
                    sapiente dolores autem earum reiciendis iste harum consequatur, provident quae vero nihil repellat unde.
                    Earum placeat veritatis rerum excepturi voluptatum, ex blanditiis quo labore quas dolorum, harum laboriosam
                    inventore sunt! Facere hic dolores suscipit quibusdam reiciendis eius maiores ratione cumque dolor. Eveniet
                    sunt illum excepturi sed nam dolore animi laborum quis asperiores commodi autem sint, repudiandae, vel
                    nulla! Minima sunt provident maiores repudiandae accusantium. Maiores, eaque sapiente porro voluptates
                    perferendis tempora nesciunt a ex qui. Dicta alias, incidunt v

                </div>


            </div>

        </div>
    </section>

    <section class="dk">
        <div id="react-container" class="container"></div>

        <div id="react-container" style="display:none;" class="container">
            <div class="graphItem">
                <div class="row">
                    <div class="col-md-6">
                        <p class="gheader">
                            Age Variation
                        </p>
                        <p class="gtext">
                            Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                            Consequat ac felis donec et odio. Natoque penatibus et magnis dis parturient montes nascetur
                        </p>
                        <div class="icons">
                            <a href="">
                                <i class="fa fa-facebook-f"></i>
                            </a>
                            <a href="">
                                <i class="fa fa-twitter"></i>
                            </a>
                            <a href="">
                                <i class="fa fa-linkedin-in"></i>
                            </a>
                            <a class="l5" href="">
                                <i class="fa fa-download"></i>
                            </a>
                            <a href="">
                                <i class="fa fa-share-alt"></i>
                            </a>
                        </div>
                    </div>
                    <div class="col-md-6 graphHolder graphfirst">
                        <!-- <img src="{% static 'public/image/graph1.png' %}" alt=""> -->
                    </div>
                </div>
            </div>



        </div>



    </section>

    {% endblock %}

    {% block scripts %}
    <script>
        $(document).ready(function () {

            $(".filterBtn").click(function () {

                $(".selectHolder.list").addClass("activated")

            });

            $(".closeBtn").click(function () {

                $(".selectHolder.list").removeClass("activated")

            });
        });


    </script>

    <script type= "text/babel">



//react Component

    class CheckBox extends React.Component {
      constructor(props){
        super(props);
        this.state ={
          checked : true
        };
        this.handleCheck = this.handleCheck.bind(this)
      }
        handleCheck= () => this.setState({checked : !this.state.checked});
        render (){
          var msg="checked";
           if (this.state.checked){
             msg= "yeschecked";
           }
           else{
            msg="unchecked";
           }

          return (
            <div>


        <div className="graphItem"> <div className="row"> <div
        className="col-md-6"> <p className="gheader"> {this.props.data_pass[0].title}  </p> <p
        className="gtext"> Lorem ipsum dolor sit amet, consectetur adipiscing
        elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
        Consequat ac felis donec et odio. Natoque penatibus et magnis dis
        parturient montes nascetur </p> <div className="icons"> <a href=""> <i
        className="fa fa-facebook-f"></i> </a> <a href=""> <i className="fa
        fa-twitter"></i> </a> <a href=""> <i className="fa fa-linkedin-in"></i>
        </a> <a className="l5" href=""> <i className="fa fa-download"></i> </a>
        <a href=""> <i className="fa fa-share-alt"></i> </a> </div> </div> <div
        className="col-md-6 graphHolder graphfirst"><svg /></div></div> </div>


        </div>
          )
        };

    }

//

    var data_pass =[ {
      title :"Age variation",
      data :[]
    }]

    ReactDOM.render(
      <div>
      <CheckBox data_pass={data_pass} />

      </div>,
      document.getElementById("react-container")
    )

//d3

const sample = [
      {
        language: 20,
        value: 20,
        color: '#000000'
      },
      {
        language: 25,
        value: 30.1,
        color: '#00a2ee'
      },
      {
        language: 30,
        value: 30.0,
        color: '#fbcb39'
      },
      {
        language: 35,
        value: 35.0,
        color: '#007bc8'
      },
      {
        language: 40,
        value: 65.6,
        color: '#65cedb'
      },
      {
        language: 45,
        value: 80.1,
        color: '#ff6e52'
      },
      {
        language: 50,
        value: 85.9,
        color: '#f9de3f'
      },
      {
        language: 55,
        value: 80.4,
        color: '#5d2f8e'
      },
      {
        language: 60,
        value: 70.6,
        color: '#008fc9'
      },
      {
        language: 65,
        value: 30.6,
        color: '#507dca'
      }
    ];

    const svg = d3.select('svg');
    const svgContainer = d3.select('.graphHolder');
    const margin = 50;
    const width = 700 - 2 * margin;
    const height = 350 - 2 * margin;
    const bar_width =30;
    var zoom =d3.zoom().scaleExtent([1,1.3]).on("zoom",function(){
        svg2.attr("transform",d3.event.transform)
    })

    const svg2 = svg
    .attr("width","100%")
    .attr("height","100%")
    .call(zoom)
    .append('g')



    const chart = svg2
     //  .attr("width","100%")
     //  .attr("height","100%")
     //  .call(zoom)
     // .append('g')
      .attr('transform', `translate(${margin}, ${margin})`);

    const xScale2 = d3.scaleBand()
      .range([0, width])
      .domain(sample.map((s) => s.language))
      .padding(1)

      const xScale = d3.scaleLinear()
        .range([0, width])
        .domain([15, 95]);


    const yScale = d3.scaleLinear()
      .range([height, 0])
      .domain([0, 100]);

    // vertical grid lines
    // const makeXLines = () => d3.axisBottom()
    //   .scale(xScale)

    const makeYLines = () => d3.axisLeft()
      .scale(yScale)

    chart.append('g')
      .attr('transform', `translate(0, ${height})`)
      .call(d3.axisBottom(xScale).tickValues(d3.range(20, 90, 5)));

    chart.append('g')
      .call(d3.axisLeft(yScale));

    // vertical grid lines
    // chart.append('g')
    //   .attr('class', 'grid')
    //   .attr('transform', `translate(0, ${height})`)
    //   .call(makeXLines()
    //     .tickSize(-height, 0, 0)
    //     .tickFormat('')
    //   )

    chart.append('g')
      .attr('class', 'grid')
      .call(makeYLines()
        .tickSize(-width, 0, 0)
        .tickFormat('')

      )

    const barGroups = chart.selectAll()
      .data(sample)
      .enter()
      .append('g')

    barGroups
      .append('rect')
      .attr('class', 'bar')
      .attr('x', (g) => xScale(g.language))
      .attr('y', (g) => yScale(g.value))
      .attr('height', (g) => height - yScale(g.value))
      .attr('width', bar_width ) //xScale.bandwidth()
      .on('mouseenter', function (actual, i) {
        d3.selectAll('.value')
          .attr('opacity', 0)


        d3.select(this)
          .transition()
          .duration(300)
          .attr('opacity', 0.6)
          .attr('x', (a) => xScale(a.language) - 5)
          .attr('width', bar_width + 10) //xScale.bandwidth()

        const y = yScale(actual.value)

        var line = chart.append('line')
          .attr('id', 'limit')
          .attr('x1', 0)
          .attr('y1', y)
          .attr('x2', width)
          .attr('y2', y)

        // barGroups.append('text')
        //   .attr('class', 'divergence')
        //   .attr('x', (a) => xScale(a.language) +  bar_width/ 2) //xScale.bandwidth()
        //   .attr('y', (a) => yScale(a.value) + 30)
        //   .attr('fill', 'white')
        //   .attr('text-anchor', 'middle')
        //   .text((a, idx) => {
        //     const divergence = (a.value - actual.value).toFixed(1)
        //
        //     let text = ''
        //     if (divergence > 0) text += '+'
        //     text += `${divergence}%`
        //
        //     return idx !== i ? text : '';
        //   })

      })
      .on('mouseleave', function () {
        d3.selectAll('.value')
          .attr('opacity', 1)

        d3.select(this)
          .transition()
          .duration(300)
          .attr('opacity', 1)
          .attr('x', (a) => xScale(a.language))
          .attr('width', bar_width) //xScale.bandwidth()

        chart.selectAll('#limit').remove()
        chart.selectAll('.divergence').remove()
      })

    barGroups
      .append('text')
      .attr('class', 'value')
      .attr('x', (a) => xScale(a.language) + bar_width / 2) //xScale.bandwidth()
      .attr('y', (a) => yScale(a.value) + 30)
      .attr('text-anchor', 'middle')
      .text((a) => `${a.value}%`)

    svg2
      .append('text')
      .attr('class', 'label')
      .attr('x', -(height / 2) - margin)
      .attr('y', margin / 2.4)
      .attr('transform', 'rotate(-90)')
      .attr('text-anchor', 'middle')
      .text('frequency(%)')

    svg2.append('text')
      .attr('class', 'label')
      .attr('x', width / 2 + margin)
      .attr('y', height+margin/1.2)
      .attr('text-anchor', 'middle')
      .text('Age')

    svg2.append('text')
      .attr('class', 'title')
      .attr('x', width / 2 + margin)
      .attr('y', -10)
      .attr('text-anchor', 'middle')
      .text('Age Variation across in 2018')

    svg2.append('text')
      .attr('class', 'source')
      .attr('x', width - margin)
      .attr('y', height-margin)
      .attr('text-anchor', 'start')
      .text('Source: Election, 2018')

    </script>
{% endblock %}
